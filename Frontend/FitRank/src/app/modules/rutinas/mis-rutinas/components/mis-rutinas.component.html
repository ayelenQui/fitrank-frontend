<button type="button" class="btn-volver btn-secondary" (click)="volverAtras()">
  Volver
</button>

<div class="vista-mis-rutinas">


  <section class="hero-fitrank d-flex align-items-center justify-content-center">
    <div class="hero-text">
      
      <h1 class="titulo hero-title">
        {{ rol === 'profesor' ? 'MIS RUTINAS CREADAS' : 'MIS RUTINAS' }}
      </h1>

      <p class="hero-subtitle text-black">
        {{
          rol === 'profesor'
          ? 'Visualiz√° y gestion√° las rutinas que creaste para tus alumnos.'
          : 'Planific√°, med√≠ tu rendimiento y superate cada semana con FitRank.'
        }}
      </p>

    
      <div class="stats-container d-flex flex-wrap justify-content-center gap-3 mt-4">
        <button class="stat-card bg-white btn-secondary">
          <span class="stat-number">{{ totalRutinas }}</span>
          <span class="text-black stat-label">
            {{ rol === 'profesor' ? 'Rutinas creadas' : 'Rutinas asignadas' }}
          </span>
        </button>

        <button class="stat-card active bg-white btn-secondary">
          <span class="stat-number">{{ rutinasActivas }}</span>
          <span class="text-black stat-label">Activas</span>
        </button>

        <button class="stat-card inactive bg-white btn-secondary">
          <span class="stat-number">{{ rutinasInactivas }}</span>
          <span class="text-black stat-label">Inactivas</span>
        </button>
      </div>
    </div>

  </section>

  <br />


  <div class="contenido-mis-rutinas">
    <button class="btn btn-secondary mb-3 btn-desactivar"
            (click)="mostrarInactivas = !mostrarInactivas">
      {{ mostrarInactivas ? 'Ocultar desactivadas' : 'Ver desactivadas' }}
    </button>

    <div *ngIf="!loading && rutinas.length > 0" class="row g-3 justify-content-left">




      <div *ngFor="let r of rutinas
      | filterRutinas: mostrarInactivas" class="col-12 col-md-4 col-lg-3">
        <div class="rutina-card bg-dark text-white p-3 rounded-4 position-relative">

          <div class="d-flex justify-content-between align-items-start mb-2">
            <h6 class="fw-bold mb-0 text-white">{{ r.nombre }}</h6>
            <span class="badge" [ngClass]="r.activa ? 'bg-success' : 'bg-secondary'">
              {{ r.activa ? 'Activa' : 'Inactiva' }}
            </span>
          </div>

   
          <p class="small text-white mb-2">{{ r.descripcion || 'Sin descripci√≥n' }}</p>

       
          <div *ngIf="rol === 'profesor'" class="detalle-profesor small text-white mb-2">
            <p class="mb-1"><strong>üë§ Socio:</strong> {{ r.socioNombre || 'No asignado' }}</p>
            <p class="mb-1"><strong>üß© Tipo:</strong> {{ r.tipo || 'Manual' }}</p>
            <p class="mb-1"><strong>üìÖ Fecha:</strong> {{ r.fechaCreacion | date: 'dd/MM/yyyy' }}</p>
          </div>

          <p *ngIf="rol === 'socio'" class="text-white small mb-3">
            <span class="material-symbols-outlined align-middle fs-6 me-1 text-white">calendar_today</span>
            {{ r.fechaCreacion | date: 'dd/MM/yyyy' }}
          </p>

          <div class="d-flex justify-content-end gap-2">


            <div class="card">

              <span class="info-icon favorito-tooltip-icon">
                <button class="favorito-btn" (click)="toggleFavorita(r)">
                  <img *ngIf="r.esFavorita"
                       src="../../../../../assets/img/icons/star-filled.svg"
                       class="icono-favorito" />
                  <img *ngIf="!r.esFavorita"
                       src="../../../../../assets/img/icons/star-outline.svg"
                       class="icono-favorito" />
                </button>


                <span class="info-tooltip">
                  Toc√° la estrella para recordarla como favorita.
                </span>
              </span>

              <div class="tooltip-mensaje" *ngIf="mostrarTooltip">
                <span class="cerrar" (click)="mostrarTooltip = false">√ó</span>
                <p> Toc√° la estrella para marcar tu rutina como favorita.</p>
              </div>

            </div>


            <span class="info-icon ojo-tooltip-icon">

              <button class="btn btn-light btn-sm"
                      (click)="toggleActiva(r)">
                <span class="material-symbols-outlined">
                  {{ r.activa ? 'visibility_off' : 'visibility' }}
                </span>
              </button>

              
              <span class="info-tooltip">
                Activ√° o desactiv√° tus rutinas.
              </span>

            </span>


         
            <button *ngIf="rol === 'socio'"
                    class="btn btn-fitrank  btn-secondary"
                    (click)="iniciarRutina(r)">
              <span class="material-symbols-outlined fs-6 align-middle me-1">play_arrow</span>
              Iniciar
            </button>


          </div>

        
          <div *ngIf="rol === 'socio' && !r.tieneSesiones" class="mt-2 text-center">
            <button class="btn btn-fitrank btn-sm fw-bold"
                    (click)="irACrearSesiones(r.id)">
              <span class="material-symbols-outlined fs-6 align-middle me-1">add_circle</span>
              Crear sesiones
            </button>
          </div>




        </div>
      </div>
    </div>

    <div *ngIf="!loading && !error && rutinas.length === 0" class="text-center text-muted mt-4">
      <p>{{ rol === 'profesor' ? 'No creaste rutinas todav√≠a.' : 'A√∫n no ten√©s rutinas creadas.' }}</p>
      <button class="btn btn-fitrank-light btn-secondary" (click)="crearRutina()">
         {{ rol === 'profesor' ? 'Crear nueva rutina' : 'Crear mi primera rutina' }}
      </button>
    </div>
  </div>
</div>
