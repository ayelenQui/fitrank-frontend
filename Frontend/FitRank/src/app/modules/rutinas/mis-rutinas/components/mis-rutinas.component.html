<button type="button" class="btn-volver btn-secondary" (click)="volverAtras()">
  Volver
</button>

<div class="vista-mis-rutinas">

  <!-- üü£ HERO SUPERIOR -->
  <section class="hero-fitrank d-flex align-items-center justify-content-between">
    <div class="hero-text">
      <!-- üîπ Cambia t√≠tulo y subt√≠tulo seg√∫n el rol -->
      <h1 class="titulo hero-title">
        {{ rol === 'profesor' ? 'MIS RUTINAS CREADAS' : 'MIS RUTINAS' }}
      </h1>

      <p class="hero-subtitle text-black">
        {{
 rol === 'profesor'
          ? 'Visualiz√° y gestion√° las rutinas que creaste para tus alumnos.'
          : 'Planific√°, med√≠ tu rendimiento y superate cada semana con FitRank.'
        }}
      </p>

      <!-- üìä Panel de estad√≠sticas -->
      <div class="stats-container d-flex flex-wrap justify-content-center gap-3 mt-4">
        <button class="stat-card bg-white btn-secondary">
          <span class="stat-number">{{ totalRutinas }}</span>
          <span class="text-black stat-label">
            {{ rol === 'profesor' ? 'Rutinas creadas' : 'Rutinas asignadas' }}
          </span>
        </button>

        <button class="stat-card active bg-white btn-secondary">
          <span class="stat-number">{{ rutinasActivas }}</span>
          <span class="text-black stat-label">Activas</span>
        </button>

        <button class="stat-card inactive bg-white btn-secondary">
          <span class="stat-number">{{ rutinasInactivas }}</span>
          <span class="text-black stat-label">Inactivas</span>
        </button>

        <!-- <button *ngIf="rol === 'socio'" class="stat-card valoracion">
          <div class="stars">
            <span class="material-symbols-outlined">star</span>
            <span class="material-symbols-outlined">star</span>
            <span class="material-symbols-outlined">star</span>
          </div>
          <span class="stat-label text-black">Valor√° tu rutina</span>
        </button> -->
      </div>
    </div>

    <!-- üì± Imagen -->
    <div class="hero-image position-relative">
      <div class="hero-bg-estatico"></div>
      <img src="assets/img/mis-rutinas/blanco.jpg" alt="App FitRank" class="hero-phone" />
    </div>
  </section>

  <br />

  <!-- ============================== -->
  <!-- üìã LISTADO DE RUTINAS -->
  <!-- ============================== -->
  <div class="contenido-mis-rutinas">
    <button class="btn btn-secondary mb-3 btn-desactivar"
            (click)="mostrarInactivas = !mostrarInactivas">
      {{ mostrarInactivas ? 'Ocultar desactivadas' : 'Ver desactivadas' }}
    </button>

    <div *ngIf="!loading && rutinas.length > 0" class="row g-3 justify-content-left">




      <div *ngFor="let r of rutinas
      | filterRutinas: mostrarInactivas" class="col-12 col-md-4 col-lg-3">
        <div class="rutina-card bg-dark text-white p-3 rounded-4 position-relative">

          <!-- üîπ Encabezado -->
          <div class="d-flex justify-content-between align-items-start mb-2">
            <h6 class="fw-bold mb-0 text-white">{{ r.nombre }}</h6>
            <span class="badge" [ngClass]="r.activa ? 'bg-success' : 'bg-secondary'">
              {{ r.activa ? 'Activa' : 'Inactiva' }}
            </span>
          </div>

          <!-- üîπ Descripci√≥n -->
          <p class="small text-white mb-2">{{ r.descripcion || 'Sin descripci√≥n' }}</p>

          <!-- üîπ Si es profesor, muestra m√°s detalle -->
          <div *ngIf="rol === 'profesor'" class="detalle-profesor small text-white mb-2">
            <p class="mb-1"><strong>üë§ Socio:</strong> {{ r.socioNombre || 'No asignado' }}</p>
            <p class="mb-1"><strong>üß© Tipo:</strong> {{ r.tipo || 'Manual' }}</p>
            <p class="mb-1"><strong>üìÖ Fecha:</strong> {{ r.fechaCreacion | date: 'dd/MM/yyyy' }}</p>
          </div>

          <!-- üîπ Si es socio, muestra solo la fecha -->
          <p *ngIf="rol === 'socio'" class="text-white small mb-3">
            <span class="material-symbols-outlined align-middle fs-6 me-1 text-white">calendar_today</span>
            {{ r.fechaCreacion | date: 'shortDate' }}
          </p>

          <!-- üîπ Acciones -->
          <div class="d-flex justify-content-end gap-2">
            <div class="card" *ngFor="let rutina of rutinas">

              <!-- bot√≥n favorito -->
              <button class="favorito-btn" (click)="toggleFavorita(rutina)">
                <img *ngIf="rutina.esFavorita"
                     src="../../../../../assets/img/icons/star-filled.svg"
                     alt="Favorito"
                     class="icono-favorito" />

                <img *ngIf="!rutina.esFavorita"
                     src="../../../../../assets/img/icons/star-outline.svg"
                     alt="No favorito"
                     class="icono-favorito" />
              </button>

              <!-- resto del contenido de la tarjeta -->

            </div>

            <!-- üîÑ Activar / Desactivar rutina -->
            <button class="btn btn-light btn-sm"
                    (click)="toggleActiva(r)">
              <span class="material-symbols-outlined">
                {{ r.activa ? 'visibility_off' : 'visibility' }}
              </span>
            </button>
            <!-- ‚ñ∂ Iniciar solo SOCIO -->
            <!-- SI TIENE SESIONES ‚Üí bot√≥n iniciar -->
            <button *ngIf="rol === 'socio' && r.tieneSesiones"
                    class="btn btn-fitrank btn-sm fw-bold btn-secondary"
                    (click)="iniciarRutina(r)">
              <span class="material-symbols-outlined fs-6 align-middle me-1">play_arrow</span>
              Iniciar
            </button>

            <!-- SI NO TIENE SESIONES ‚Üí mensaje -->
            <div *ngIf="rol === 'socio' && !r.tieneSesiones"
                 class="alert-sin-sesiones small mt-2">
              ‚ö† Carg√° tus sesiones para poder iniciar
            </div>

          </div>

          <!-- üîπ √çconos sociales (solo para socios) -->
          <!-- <div *ngIf="rol === 'socio'" class="d-flex justify-content-around align-items-center mt-3 border-top pt-2">
            <button class="icon-btn"><span class="material-symbols-outlined">favorite</span></button>
            <button class="icon-btn"><span class="material-symbols-outlined">bookmark</span></button>
            <button class="icon-btn"><span class="material-symbols-outlined">chat_bubble</span></button>
            <button class="icon-btn"><span class="material-symbols-outlined">share</span></button>
          </div> -->

        </div>
      </div>
    </div>

    <!-- üîπ Mensaje si no hay rutinas -->
    <div *ngIf="!loading && !error && rutinas.length === 0" class="text-center text-muted mt-4">
      <p>{{ rol === 'profesor' ? 'No creaste rutinas todav√≠a.' : 'A√∫n no ten√©s rutinas creadas.' }}</p>
      <button class="btn btn-fitrank-light btn-secondary" (click)="crearRutina()">
         {{ rol === 'profesor' ? 'Crear nueva rutina' : 'Crear mi primera rutina' }}
      </button>
    </div>
  </div>
</div>
